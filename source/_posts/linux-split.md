title: 切分日志文件
date: 2016.01.26
categories: linux #分类
tags: [linux]
toc: true
---
　日志文件非常重要，由于各种原因．日志文件可能比较乱，那怎么从日志中提取有用信息呢．我个人认为．需要从两个维度上去解析．
* 一是从水平方向上去分析．
* 一是从垂直方向上去分析．
 水平方向上分析日志文件，可以使用**split**，*awk*等命令．
 垂直方向，可以使用**awk**,**cut**等命令．
 本次先讲水平切分日志文件．

问题提出：
手头有一份网上抓取的头像文件．通过微软牛津计划提供的人脸识别api,识别了老师的面部表情信息．但是，日志很乱，而且由于程序有BUG,多次程序运行的日志，混在同一个日志，我想提取最后一次正确运行的日志，怎么办？
答案：提取日志．先水平切分，获取最后一次成功运行的日志．

## 找到行号
fgrep 配合**-n**，即可．
```
$ fgrep -n "当前处理的教师id　：1" ../bin/nohup.out | less
1176:17:10:02,025  INFO EmotionJob:68 - 当前处理的教师id　：1
1178:当前处理的教师id　：1
1242:17:10:58,293  INFO EmotionJob:68 - 当前处理的教师id　：10
```

## 水平切分
使用awk，指定行号
```
$ awk '{if(NR>1175) print $0}' nohup.log > new.log
```

## 过滤
提取通过log4j输出的日志
```
$ grep "INFO EmotionJob" new.log > new1.log
```

## 垂直切分
```
$ awk -F ":" '{PRINT $2}' > new2.log
```

